{"version":3,"file":"guardian.cjs.js","sources":["../src/Context.js","../src/Provider.js","../src/hooks/useAuth.js","../src/withAuth.js"],"sourcesContent":["/**\r\n * @author Ray\r\n * @description Context\r\n */\r\nimport React from 'react';\r\n\r\n/**\r\n * @description 权限控制的上下文对象\r\n * @type {React.Context<{permissions: []}>}\r\n */\r\nexport const ReactAuthContext = React.createContext({\r\n    permissions: []\r\n});\r\n\r\nexport default ReactAuthContext;\r\n","/**\r\n * @author Ray\r\n * @description 提供一个权限使用的上下文\r\n */\r\nimport React from 'react';\r\nimport { ReactAuthContext } from './Context';\r\n\r\n/**\r\n * @description 顶层组件，将权限代码传向整个组件数。\r\n * @param children\r\n * @param permissions\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport default function Provider({ children, permissions }) {\r\n    return (\r\n        <ReactAuthContext.Provider\r\n            value={{\r\n                permissions\r\n            }}\r\n        >\r\n            {children}\r\n        </ReactAuthContext.Provider>\r\n    );\r\n}\r\n","/**\r\n * @author ray\r\n * @description 获取权限\r\n */\r\nimport { useContext } from 'react';\r\nimport { ReactAuthContext } from '../Context';\r\n\r\n/**\r\n *\r\n * @returns {{permissions: *[]}}\r\n */\r\nexport default function useAuth() {\r\n    const context = useContext(ReactAuthContext);\r\n\r\n    return context;\r\n}\r\n","/**\r\n * @author Ray\r\n * @description 获取context中存储的permission，判断如何处理包含的子组件。\r\n */\r\nimport useAuth from './hooks/useAuth';\r\nimport { inArray } from '@westernwood/utils';\r\n/**\r\n *\r\n * @param key\r\n * @returns {function(*): function(*): (boolean|*)}\r\n */\r\nexport function withAuth(key) {\r\n    /**\r\n     * @param component\r\n     */\r\n    return function(component) {\r\n        /**\r\n         * @param props\r\n         */\r\n        return function wrap(props) {\r\n            const { permissions } = useAuth();\r\n\r\n            return inArray(key, permissions) ? component({ ...props }) : null;\r\n        };\r\n    };\r\n}\r\n\r\nexport default withAuth;\r\n"],"names":["ReactAuthContext","React","createContext","permissions","Provider","children","useAuth","context","useContext","withAuth","key","component","wrap","props","inArray"],"mappings":";;;;;;;;;;AAAA;;;;AAIA,AAEA;;;;;AAIA,AAAO,IAAMA,gBAAgB,GAAGC,cAAK,CAACC,aAAN,CAAoB;EAChDC,WAAW,EAAE;CADe,CAAzB;;ACVP;;;;AAIA,AAGA;;;;;;;;AAOA,AAAe,SAASC,QAAT,OAA6C;MAAzBC,QAAyB,QAAzBA,QAAyB;MAAfF,WAAe,QAAfA,WAAe;SAEpDF,6BAAC,gBAAD,CAAkB,QAAlB;IACI,KAAK,EAAE;MACHE,WAAW,EAAXA;;KAGHE,QALL,CADJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfJ;;;;AAIA,AAGA;;;;;AAIA,AAAe,SAASC,OAAT,GAAmB;MACxBC,OAAO,GAAGC,gBAAU,CAACR,gBAAD,CAA1B;SAEOO,OAAP;;;ACRJ;;;;;;AAKA,AAAO,SAASE,QAAT,CAAkBC,GAAlB,EAAuB;;;;SAInB,UAASC,SAAT,EAAoB;;;;WAIhB,SAASC,IAAT,CAAcC,KAAd,EAAqB;qBACAP,OAAO,EADP;UAChBH,WADgB,YAChBA,WADgB;;aAGjBW,aAAO,CAACJ,GAAD,EAAMP,WAAN,CAAP,GAA4BQ,SAAS,oBAAME,KAAN,EAArC,GAAsD,IAA7D;KAHJ;GAJJ;;;;;;;;"}