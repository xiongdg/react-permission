{"version":3,"file":"guardian.umd.js","sources":["../src/Context.js","../src/Provider.js","../src/withPermission.js"],"sourcesContent":["/**\r\n * @author Ray\r\n * @description Context\r\n */\r\nimport React from 'react';\r\n\r\nexport const ReactAuthContext = React.createContext({\r\n    permissions: []\r\n});\r\n\r\nexport default ReactAuthContext;\r\n","/**\r\n * @author Ray\r\n * @description 提供一个权限使用的上下文\r\n */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { ReactAuthContext } from './Context';\r\n\r\nexport default function Provider({ children, context, permissions }) {\r\n    let Context = ReactAuthContext;\r\n    const [pms, setPermissions] = useState([]);\r\n\r\n    useEffect(\r\n        function() {\r\n            if (permissions.then) {\r\n                permissions.then(function(p) {\r\n                    setPermissions(p);\r\n                });\r\n            } else {\r\n                setPermissions(permissions);\r\n            }\r\n        },\r\n        [permissions]\r\n    );\r\n\r\n    if (context) {\r\n        Context = context;\r\n    }\r\n\r\n    return <Context.Provider value={{ permissions: pms }}>{children}</Context.Provider>;\r\n}\r\n","/**\r\n * @author Ray\r\n * @description 获取context中存储的permission，判断如何处理包含的子组件。\r\n */\r\nimport { useContext } from 'react';\r\nimport ReactAuthContext from './Context';\r\n\r\n/**\r\n * @description 返回一个新的组建，适用于函数组件\r\n * @param authKey\r\n * @returns {function(*): Function}\r\n */\r\nexport const withPermission = authKey => wrapComponent => props => {\r\n    const authKeys = useContext(ReactAuthContext);\r\n\r\n    if (authKey in authKeys) {\r\n        return wrapComponent({ ...props });\r\n    }\r\n    return null;\r\n};\r\n\r\nexport default withPermission;\r\n"],"names":["ReactAuthContext","React","createContext","permissions","Provider","children","context","Context","useState","pms","setPermissions","useEffect","then","p","withPermission","authKey","wrapComponent","props","authKeys","useContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;;;;AAIA,EAEO,IAAMA,gBAAgB,GAAGC,cAAK,CAACC,aAAN,CAAoB;EAChDC,EAAAA,WAAW,EAAE;EADmC,CAApB,CAAzB;;ECCQ,SAASC,QAAT,OAAsD;EAAA,MAAlCC,QAAkC,QAAlCA,QAAkC;EAAA,MAAxBC,OAAwB,QAAxBA,OAAwB;EAAA,MAAfH,WAAe,QAAfA,WAAe;EACjE,MAAII,OAAO,GAAGP,gBAAd;;EADiE,kBAEnCQ,cAAQ,CAAC,EAAD,CAF2B;EAAA;EAAA,MAE1DC,GAF0D;EAAA,MAErDC,cAFqD;;EAIjEC,EAAAA,eAAS,CACL,YAAW;EACP,QAAIR,WAAW,CAACS,IAAhB,EAAsB;EAClBT,MAAAA,WAAW,CAACS,IAAZ,CAAiB,UAASC,CAAT,EAAY;EACzBH,QAAAA,cAAc,CAACG,CAAD,CAAd;EACH,OAFD;EAGH,KAJD,MAIO;EACHH,MAAAA,cAAc,CAACP,WAAD,CAAd;EACH;EACJ,GATI,EAUL,CAACA,WAAD,CAVK,CAAT;;EAaA,MAAIG,OAAJ,EAAa;EACTC,IAAAA,OAAO,GAAGD,OAAV;EACH;;EAED,SAAOL,6BAAC,OAAD,CAAS,QAAT;EAAkB,IAAA,KAAK,EAAE;EAAEE,MAAAA,WAAW,EAAEM;EAAf;EAAzB,KAAgDJ,QAAhD,CAAP;EACH;;ECtBD;;;;;;AAKA,EAAO,IAAMS,cAAc,GAAG,SAAjBA,cAAiB,CAAAC,OAAO;EAAA,SAAI,UAAAC,aAAa;EAAA,WAAI,UAAAC,KAAK,EAAI;EAC/D,UAAMC,QAAQ,GAAGC,gBAAU,CAACnB,gBAAD,CAA3B;;EAEA,UAAIe,OAAO,IAAIG,QAAf,EAAyB;EACrB,eAAOF,aAAa,oBAAMC,KAAN,EAApB;EACH;;EACD,aAAO,IAAP;EACH,KAPqD;EAAA,GAAjB;EAAA,CAA9B;;;;;;;;;;;;;"}